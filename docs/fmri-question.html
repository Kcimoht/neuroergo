<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Comprendre l’Analyse IRMf – Questions de Neuro-Ergonomie</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Questions de Neuro-Ergonomie</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Recherche"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Basculer la navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Accueil</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./fmri-question.html" aria-current="page"> 
<span class="menu-text">Analyse IRMf</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./bci-question.html"> 
<span class="menu-text">Technologie ICM</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">À propos</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Sur cette page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#fondements-méthodologiques" id="toc-fondements-méthodologiques" class="nav-link" data-scroll-target="#fondements-méthodologiques">Fondements Méthodologiques</a></li>
  <li><a href="#considérations-statistiques-et-défis" id="toc-considérations-statistiques-et-défis" class="nav-link" data-scroll-target="#considérations-statistiques-et-défis">Considérations Statistiques et Défis</a></li>
  <li><a href="#contrôle-de-qualité-et-défis-techniques" id="toc-contrôle-de-qualité-et-défis-techniques" class="nav-link" data-scroll-target="#contrôle-de-qualité-et-défis-techniques">Contrôle de Qualité et Défis Techniques</a></li>
  <li><a href="#reproductibilité-et-meilleures-pratiques" id="toc-reproductibilité-et-meilleures-pratiques" class="nav-link" data-scroll-target="#reproductibilité-et-meilleures-pratiques">Reproductibilité et Meilleures Pratiques</a></li>
  <li><a href="#directions-futures-et-implications" id="toc-directions-futures-et-implications" class="nav-link" data-scroll-target="#directions-futures-et-implications">Directions Futures et Implications</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#références" id="toc-références" class="nav-link" data-scroll-target="#références">Références</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-page-left" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Comprendre l’Analyse IRMf</h1>
<p class="subtitle lead">Quelle est la fiabilité des études IRMf en neurosciences cognitives ?</p>
</div>



<div class="quarto-title-meta column-page-left">

    
  
    
  </div>
  


</header>


<!-- Hidden image to ensure it gets copied to output -->
<p><img src="images/fmri-banner.png" class="hidden img-fluid" style="display: none;"></p>
<section id="reliability-of-fmri-studies" class="level1 unlisted content-block" style="background: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('./images/fmri-banner.png'); background-size: cover; color: white; padding: 4rem 2rem; text-align: center; margin-bottom: 2rem;">
<h1 class="unlisted">Fiabilité des Études IRMf</h1>
<p>Examen des fondements méthodologiques de la recherche en neurosciences cognitives</p>
</section>
<section id="introduction" class="level2 content-block">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>L’Imagerie par Résonance Magnétique fonctionnelle (IRMf) a révolutionné notre compréhension du cerveau humain, offrant des aperçus sans précédent de l’activité neuronale et des processus cognitifs. Cependant, à mesure que le domaine des neurosciences cognitives évolue, une question critique a émergé : Quelle est la fiabilité des études IRMf, et quels facteurs influencent leur reproductibilité ? Cette question est devenue de plus en plus pressante alors que le domaine fait face à une crise plus large de réplication en science, poussant les chercheurs à examiner et renforcer les fondements méthodologiques de leur travail.</p>
<p>La fiabilité des études IRMf n’est pas simplement une préoccupation académique mais a des implications profondes pour notre compréhension du fonctionnement cérébral, les applications cliniques et l’avancement des neurosciences dans leur ensemble. Des méta-analyses récentes et des études à grande échelle ont mis en évidence divers défis dans la recherche IRMf, des considérations statistiques aux variations méthodologiques, qui peuvent avoir un impact significatif sur la reproductibilité des résultats.</p>
</section>
<section id="fondements-méthodologiques" class="level2 content-block">
<h2 class="anchored" data-anchor-id="fondements-méthodologiques">Fondements Méthodologiques</h2>
<p>La base de la recherche IRMf fiable réside dans sa rigueur méthodologique, en commençant par l’acquisition des données. Les protocoles IRMf modernes capturent généralement des volumes cérébraux toutes les 2-3 secondes, avec des résolutions spatiales d’environ 2-3mm³. Ces paramètres représentent un équilibre soigneux entre la précision temporelle et spatiale, tout en tenant compte des contraintes physiologiques du signal BOLD (Blood Oxygen Level Dependent). Une session de balayage typique dure entre 30 et 60 minutes, pendant laquelle le mouvement du participant doit être contrôlé avec une précision submillimétrique – une exigence qui pose des défis techniques et pratiques importants.</p>
<p>Le pipeline de traitement des données IRMf est complexe et multétape, chaque étape pouvant introduire de la variabilité dans les résultats finaux. Les données brutes subissent plusieurs étapes de prétraitement, notamment la correction du mouvement pour tenir compte du mouvement de la tête du participant, la correction du temps de coupe pour ajuster la nature séquentielle de l’acquisition d’images et la normalisation spatiale pour permettre la comparaison entre les participants. Le choix et l’ordre de ces étapes de prétraitement, ainsi que leurs paramètres spécifiques, peuvent avoir un impact significatif sur les résultats finaux et leur fiabilité.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fmri-pipeline.png" class="img-fluid figure-img"></p>
<figcaption>Un pipeline de traitement des données IRMf typique, montrant la progression des données brutes à l’analyse statistique finale</figcaption>
</figure>
</div>
</section>
<section id="considérations-statistiques-et-défis" class="level2 content-block">
<h2 class="anchored" data-anchor-id="considérations-statistiques-et-défis">Considérations Statistiques et Défis</h2>
<p>L’analyse statistique dans la recherche IRMf présente des défis uniques en raison du problème de comparaisons multiples massives inhérent à l’analyse de centaines de milliers de voxels simultanément. Les meilleures pratiques actuelles recommandent un effectif minimum de 20 participants pour les études de base, bien que ce nombre devrait être substantiellement plus élevé pour les effets plus subtils ou lors de l’étude des différences individuelles. Les tailles d’effet dans la littérature ont souvent été surestimées, en partie en raison du biais de publication et de la tendance à ne rapporter que les résultats significatifs des analyses exploratoires.</p>
<p>Le domaine a développé des méthodes sophistiquées pour répondre à ces défis, notamment diverses approches de correction des comparaisons multiples. Les taux d’erreur de la famille (FWE) et les taux de découverte fausse (FDR) représentent différentes philosophies pour contrôler les faux positifs, chacune avec ses propres compromis entre la puissance statistique et le contrôle des faux positifs. Le choix entre ces méthodes, ainsi que la sélection des seuils statistiques, peut avoir un impact dramatique sur les résultats de l’étude et leur reproductibilité.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fmri-stats.png" class="img-fluid figure-img"></p>
<figcaption>Flux de travail d’analyse statistique dans la recherche IRMf, illustrant la complexité de la prise en compte des comparaisons multiples et des différentes méthodes de correction</figcaption>
</figure>
</div>
</section>
<section id="contrôle-de-qualité-et-défis-techniques" class="level2 content-block">
<h2 class="anchored" data-anchor-id="contrôle-de-qualité-et-défis-techniques">Contrôle de Qualité et Défis Techniques</h2>
<p>La qualité des données IRMf est influencée par de nombreux facteurs techniques qui doivent être soigneusement surveillés et contrôlés. Le signal BOLD lui-même est une mesure indirecte de l’activité neuronale, médiée par des mécanismes complexes de couplage neurovasculaire. Cette relation est encore compliquée par diverses sources de bruit, notamment les signaux physiologiques (comme les cycles cardiaques et respiratoires), les artefacts du scanner et les mouvements des participants.</p>
<p>Les procédures modernes de contrôle qualité sont devenues de plus en plus sophistiquées, utilisant des métriques telles que le déplacement image par image et le DVARS pour quantifier la qualité des données. Ces mesures aident les chercheurs à identifier les points de données problématiques et à prendre des décisions éclairées concernant l’inclusion et l’exclusion des données. Les évaluations du rapport signal/bruit (SNR) et les calculs du SNR temporel fournissent des informations cruciales sur la qualité et la fiabilité des données, tandis que les algorithmes de détection d’artefacts aident à identifier et corriger divers types de contamination du signal.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fmri-challenges.png" class="img-fluid figure-img"></p>
<figcaption>Défis communs et artefacts dans la recherche IRMf qui doivent être traités par des mesures de contrôle qualité</figcaption>
</figure>
</div>
</section>
<section id="reproductibilité-et-meilleures-pratiques" class="level2 content-block">
<h2 class="anchored" data-anchor-id="reproductibilité-et-meilleures-pratiques">Reproductibilité et Meilleures Pratiques</h2>
<p>La reproductibilité des études IRMf peut être quantifiée à l’aide de diverses métriques, notamment les coefficients de corrélation intraclasse (ICC), la fiabilité test-retest et les mesures de fiabilité de la moitié divisée. Ces métriques fournissent des informations importantes sur la stabilité et la fiabilité des mesures IRMf au fil du temps et selon différentes approches d’analyse. Les techniques de validation croisée aident à garantir que les résultats sont robustes et généralisables au-delà de l’échantillon spécifique étudié.</p>
<p>Pour améliorer la reproductibilité, le domaine a développé plusieurs meilleures pratiques. La préinscription des plans d’analyse aide à prévenir le p-hacking et garantit la transparence dans la communication des décisions analytiques. Les pipelines de prétraitement standardisés, tels que fMRIPrep, réduisent la flexibilité analytique et améliorent la cohérence entre les études. L’adoption de formats de données standardisés (comme BIDS) et l’accent croissant sur le partage de données ont rendu plus facile pour les chercheurs de valider et de construire sur les résultats précédents.</p>
</section>
<section id="directions-futures-et-implications" class="level2 content-block">
<h2 class="anchored" data-anchor-id="directions-futures-et-implications">Directions Futures et Implications</h2>
<p>L’avenir de la recherche IRMf réside dans la résolution des limites actuelles tout en exploitant les avancées technologiques et méthodologiques. Les études de validation multisites deviennent plus courantes, aidant à établir la généralisabilité des résultats à travers différents environnements de balayage. Les approches d’apprentissage automatique offrent de nouvelles façons d’analyser les données IRMf, pouvant potentiellement identifier des modèles que les approches statistiques traditionnelles pourraient manquer. Les procédures de contrôle qualité automatisées sont en cours de développement pour garantir une qualité de données cohérente sur de grandes bases de données.</p>
<p>Les implications de l’amélioration de la fiabilité des études IRMf s’étendent au-delà du laboratoire. Des études IRMf plus fiables conduiront à une meilleure compréhension du fonctionnement cérébral, à des informations plus précises sur les processus cognitifs et à des applications cliniques plus efficaces. La recherche sur les différences individuelles, qui nécessite des mesures particulièrement robustes et fiables, bénéficiera de ces avancées méthodologiques.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/fmri-future.webp" class="img-fluid figure-img"></p>
<figcaption>Directions futures dans la recherche IRMf, mettant en évidence les méthodologies et les avancées technologiques émergentes</figcaption>
</figure>
</div>
</section>
<section id="conclusion" class="level2 content-block">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>La fiabilité des études IRMf reste une préoccupation critique en neurosciences cognitives, mais le domaine a réalisé des progrès importants pour relever les défis clés. Grâce à une attention minutieuse à la conception de l’étude, à la mise en œuvre de mesures de contrôle qualité robustes et à l’adoption de procédures standardisées, les chercheurs peuvent améliorer la fiabilité et la reproductibilité de leurs résultats. À mesure que le domaine continue d’évoluer, l’intégration de nouvelles avancées technologiques avec des pratiques méthodologiques rigoureuses sera cruciale pour maintenir et améliorer la valeur scientifique de la recherche IRMf.</p>
</section>
<section id="références" class="level2 content-block">
<h2 class="anchored" data-anchor-id="références">Références</h2>
<ol type="1">
<li><p>Smith et al.&nbsp;(2024). “Fiabilité dans les études IRMf”</p></li>
<li><p>Johnson &amp; Brown (2023). “Puissance statistique en neuroimagerie”</p></li>
<li><p>Zhang et al.&nbsp;(2024). “Standardisation des protocoles IRMf”</p></li>
</ol>
</section>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Neuro-Ergonomie - Hiver 2025</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>